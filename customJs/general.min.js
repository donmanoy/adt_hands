$(document).ready(function () {
    generateRangeNum(1, 65);
    generateRateNum(0, 10);
    svgGraph = $("#graph");
    drawAxis(svgGraph);
	
	//for the age
    $("#slider-range").slider({
        range: true,
        min: 1,
        max: 65,
        values: [age_today, age_univ],
        slide: function (b, c) {
            $("#range_num div").hide();
            $("#range_" + c.values[0]).show();
            $("#range_" + c.values[1]).show();
            ageDiff(c.values[0], c.values[1]);
            age_today = c.values[0];
            age_univ = c.values[1]
        }
    });
    $("#range_" + $("#slider-range").slider("values", 0)).show();
    $("#range_" + $("#slider-range").slider("values", 1)).show();
    ageDiff($("#slider-range").slider("values", 0), $("#slider-range").slider("values", 1));
	
	//rate of return
    $("#slider-rate").slider({
        range: false,
        min: 0,
        max: 100,
        value: (return_per_annual * 10),
        slide: function (b, c) {
            $("#rate_num div").hide();
            $("#rate_" + c.value).show();
            return_per_annual = c.value / 10
        }
    });
	
    $("#rate_" + $("#slider-rate").slider("value")).show();
    startGraph();
    $("#front").click(function (b) {
        $("#keypad").hide();
        $("#keypad_pointer").hide()
    });
    $("#keypad").click(function (b) {
        b.stopPropagation()
    });
    var a;
    $("#expected_cost").click(function (b) {
		
        a = $(this).find(".input");
        $("#keypad").show();
        $("#keypad_pointer").css("top", "5px").show();
        b.stopPropagation()
    });
    $("#current_saving").click(function (b) {
        a = $(this).find(".input");
        $("#keypad").show();
        $("#keypad_pointer").css("top", "45px").show();
        b.stopPropagation()
    });
    $("#monthly_saving").click(function (b) {
        a = $(this).find(".input");
        $("#keypad").show();
        $("#keypad_pointer").css("top", "339px").show();
        b.stopPropagation()
    });
    $("#calculate_btn").click(function () {
        startGraph();
    });
	
	
    $(".help_box .close_btn").click(function () {
        $(".help_box").hide()
    });
    $("#q1_help").click(function () {
        $(".help_box").hide();
        $("#quick_help1").show()
    });
    $("#q2_help").click(function () {
        $(".help_box").hide();
        $("#quick_help2").show()
    });
    $("#q3_help").click(function () {
        $(".help_box").hide();
        $("#quick_help3").show()
    });
    $("#q4_help").click(function () {
        $(".help_box").hide();
        $("#quick_help4").show()
    });
	$("#important_notes").click(function () {alert("shit");
        $(".help_box").hide();
        $("#quick_help5").show()
    })
    $("#clickInfo").click(function () {
        $(".help_box").hide();
        $("#more_info").show();
    })
});

//damn graph
function startGraph() {
    //total_cost = removeFormat($("#expected_cost .input").html());
    current_saving = removeFormat($("#current_saving .input").html());
    monthly_saving = removeFormat($("#monthly_saving .input").html());
	
	inputAge = removeFormat($("#expected_cost .input").html());// change this to input age
	
    datas = generateDatas();
	drawGraphData(datas, inputAge);
	
    var a = calculateAdditionalSavingNeeded();
    $("#additional_save").html(formatNumber(a, 0))
}

function generateRangeNum(d, a) {
    var b = 9.3;
    var f = 0;
    for (var c = d; c <= a; c++) {
        $("#range_num").append('<div id="range_' + c + '" class="num">' + c + "</div>");
        var e = f * b;
        f++;
        $("#range_num #range_" + c).css("left", e + "px")
    }
}
function generateRateNum(d, a) {
    var b = 1.05;
    var f = 0;
    for (var c = d; c <= (a * 10); c++) {
        $("#rate_num").append('<div id="rate_' + c + '" class="num">' + (c / 10) + "%</div>");
        var e = f * b;
        f++;
        $("#rate_num #rate_" + c).css("left", e + "px")
    }
}
function ageDiff(b, a) {
    var c = a - b;
    $("#age_diff").html(c)
}
function formatNumber(c, b) {
    var f = c % 1;
    var a = Math.round(f * Math.pow(10, b));
    var d = (c - f) + "";
    var h = "";
    var g = 0;
    for (var e = d.length - 1; e >= 0; e--) {
        if (g == 3) {
            h = d.charAt(e) + "," + h;
            g = 1
        } else {
            h = d.charAt(e) + h;
            g++
        }
    }
    if (b == 0) {
        return h
    }
    return h + "." + a
};